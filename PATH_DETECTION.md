# ğŸ” æ™ºèƒ½å­˜æ¡£è·¯å¾„æ£€æµ‹åŠŸèƒ½

æœ¬æ–‡æ¡£è¯´æ˜æ˜Ÿéœ²è°·ç‰©è¯­å­˜æ¡£ç®¡ç†å™¨çš„æ™ºèƒ½è·¯å¾„æ£€æµ‹æœºåˆ¶ã€‚

## ğŸ¯ åŠŸèƒ½æ¦‚è¿°

ç³»ç»Ÿä¼šè‡ªåŠ¨æ£€æµ‹å¹¶é€‰æ‹©æœ€åˆé€‚çš„å­˜æ¡£è·¯å¾„ï¼Œç¡®ä¿ä¸å…¶ä»–ç›¸å…³é¡¹ç›®ï¼ˆå¦‚ `stardew-multiplayer-docker`ï¼‰çš„å…¼å®¹æ€§ã€‚

## ğŸ“ è·¯å¾„ä¼˜å…ˆçº§

ç³»ç»ŸæŒ‰ä»¥ä¸‹ä¼˜å…ˆçº§é¡ºåºæŸ¥æ‰¾å­˜æ¡£è·¯å¾„ï¼š

### 1. ä¸»è¦ç›®æ ‡è·¯å¾„ (ä¼˜å…ˆçº§1)
```
../stardew-multiplayer-docker/valley_saves
```
- **ç”¨é€”**: ä¸ stardew-multiplayer-docker é¡¹ç›®å…±äº«å­˜æ¡£
- **åœºæ™¯**: å¤šäººæ¸¸æˆæœåŠ¡å™¨å­˜æ¡£ç®¡ç†
- **ç‰¹ç‚¹**: è‡ªåŠ¨æ£€æµ‹å’Œåˆ›å»º

### 2. å¤‡ç”¨è·¯å¾„1 (ä¼˜å…ˆçº§2)
```
../valley_saves
```
- **ç”¨é€”**: é¡¹ç›®åŒçº§ç›®å½•å­˜æ¡£
- **åœºæ™¯**: ç®€åŒ–çš„å­˜æ¡£ç®¡ç†
- **ç‰¹ç‚¹**: é€šç”¨å¤‡ç”¨é€‰é¡¹

### 3. å¤‡ç”¨è·¯å¾„2 (ä¼˜å…ˆçº§3)
```
./valley_saves
```
- **ç”¨é€”**: é¡¹ç›®å†…éƒ¨å­˜æ¡£
- **åœºæ™¯**: ç‹¬ç«‹è¿è¡Œæ—¶çš„é»˜è®¤é€‰æ‹©
- **ç‰¹ç‚¹**: å§‹ç»ˆå¯ç”¨

## ğŸ”§ å·¥ä½œæœºåˆ¶

### å¯åŠ¨æ—¶è·¯å¾„æ£€æµ‹
1. **è·¯å¾„æ‰«æ**: æŒ‰ä¼˜å…ˆçº§é¡ºåºæ£€æŸ¥æ¯ä¸ªè·¯å¾„
2. **å­˜åœ¨æ€§éªŒè¯**: æ£€æŸ¥è·¯å¾„æ˜¯å¦å­˜åœ¨ä¸”ä¸ºç›®å½•
3. **è‡ªåŠ¨åˆ›å»º**: å¯¹ä¸»è¦ç›®æ ‡è·¯å¾„å°è¯•è‡ªåŠ¨åˆ›å»º
4. **é™çº§å¤„ç†**: å¦‚æœé«˜ä¼˜å…ˆçº§è·¯å¾„ä¸å¯ç”¨ï¼Œè‡ªåŠ¨é™çº§åˆ°ä¸‹ä¸€ä¸ª
5. **æœ€ç»ˆç¡®å®š**: ä½¿ç”¨ç¬¬ä¸€ä¸ªå¯ç”¨çš„æœ‰æ•ˆè·¯å¾„

### è·¯å¾„å®‰å…¨éªŒè¯
- âœ… æ”¯æŒåˆæ³•çš„ç›¸å¯¹è·¯å¾„ï¼ˆåŒ…å« `..`ï¼‰
- âŒ é˜»æ­¢è®¿é—®ç³»ç»Ÿå…³é”®ç›®å½•ï¼ˆ`/etc`, `/bin` ç­‰ï¼‰
- âœ… è·¯å¾„æ¸…ç†å’Œæ ‡å‡†åŒ–
- âœ… ç»å¯¹è·¯å¾„å®‰å…¨æ£€æŸ¥

## ğŸš€ API æ¥å£

### è·å–è·¯å¾„ä¿¡æ¯
```http
GET /api/path-info
```

**å“åº”ç¤ºä¾‹**:
```json
{
  "success": true,
  "data": {
    "currentPath": "../stardew-multiplayer-docker/valley_saves",
    "pathStatus": [
      {
        "path": "../stardew-multiplayer-docker/valley_saves",
        "priority": 1,
        "exists": true,
        "isDir": true,
        "current": true
      },
      {
        "path": "../valley_saves", 
        "priority": 2,
        "exists": false,
        "isDir": false,
        "error": "stat ../valley_saves: no such file or directory"
      },
      {
        "path": "./valley_saves",
        "priority": 3,
        "exists": true,
        "isDir": true,
        "current": false
      }
    ]
  }
}
```

### è·å–å½“å‰è·¯å¾„
```http
GET /api/current-path
```

### è®¾ç½®è‡ªå®šä¹‰è·¯å¾„
```http
POST /api/set-path
Content-Type: application/json

{
  "path": "/custom/path/to/saves"
}
```

### éªŒè¯è·¯å¾„
```http
GET /api/validate-path?path=/path/to/validate
```

## ğŸ§ª æµ‹è¯•åŠŸèƒ½

ä½¿ç”¨æä¾›çš„æµ‹è¯•è„šæœ¬éªŒè¯è·¯å¾„æ£€æµ‹ï¼š

```bash
./test_path_detection.sh
```

æµ‹è¯•å†…å®¹åŒ…æ‹¬ï¼š
- âœ… ç›®å½•åˆ›å»ºæµ‹è¯•
- âœ… è·¯å¾„æ£€æµ‹æµ‹è¯•  
- âœ… APIç«¯ç‚¹æµ‹è¯•
- âœ… æœåŠ¡å¯åŠ¨æµ‹è¯•

## ğŸ³ Docker é…ç½®

Docker Compose è‡ªåŠ¨æŒ‚è½½å¤šä¸ªè·¯å¾„ï¼š

```yaml
volumes:
  - ./valley_saves:/app/valley_saves
  - ../stardew-multiplayer-docker/valley_saves:/app/stardew-multiplayer-docker/valley_saves
```

## ğŸ’¡ ä½¿ç”¨å»ºè®®

### å¤šäººæ¸¸æˆåœºæ™¯
å¦‚æœæ‚¨ä½¿ç”¨ `stardew-multiplayer-docker` è¿è¡Œå¤šäººæ¸¸æˆæœåŠ¡å™¨ï¼š
1. ç¡®ä¿ä¸¤ä¸ªé¡¹ç›®åœ¨åŒçº§ç›®å½•
2. ç³»ç»Ÿä¼šè‡ªåŠ¨æ£€æµ‹å¹¶ä½¿ç”¨å…±äº«çš„å­˜æ¡£ç›®å½•
3. æ”¯æŒç»Ÿä¸€çš„å­˜æ¡£ç®¡ç†

### å•æœºæ¸¸æˆåœºæ™¯  
å¦‚æœåªæ˜¯ç®¡ç†ä¸ªäººå­˜æ¡£ï¼š
1. ç³»ç»Ÿä¼šè‡ªåŠ¨é™çº§åˆ°æœ¬åœ°è·¯å¾„
2. æ— éœ€é¢å¤–é…ç½®
3. å¼€ç®±å³ç”¨

### è‡ªå®šä¹‰è·¯å¾„
é€šè¿‡ Web ç•Œé¢æˆ– API å¯ä»¥è®¾ç½®ä»»æ„è‡ªå®šä¹‰è·¯å¾„ï¼š
1. è®¿é—®"è·¯å¾„è®¾ç½®"é¡µé¢
2. è¾“å…¥ç›®æ ‡è·¯å¾„
3. ç³»ç»Ÿè‡ªåŠ¨éªŒè¯å¹¶åˆ‡æ¢

## ğŸ”’ å®‰å…¨ç‰¹æ€§

- **è·¯å¾„éå†é˜²æŠ¤**: é˜²æ­¢ `../../../etc/passwd` ç±»å‹çš„æ”»å‡»
- **ç³»ç»Ÿç›®å½•ä¿æŠ¤**: ç¦æ­¢è®¿é—®å…³é”®ç³»ç»Ÿç›®å½•
- **æƒé™æ£€æŸ¥**: éªŒè¯è·¯å¾„çš„è¯»å†™æƒé™
- **è¾“å…¥éªŒè¯**: æ¸…ç†å’Œæ ‡å‡†åŒ–æ‰€æœ‰è·¯å¾„è¾“å…¥

## ğŸ“ å¸¸è§é—®é¢˜

**Q: ä¸ºä»€ä¹ˆä¼˜å…ˆä½¿ç”¨ `stardew-multiplayer-docker/valley_saves`ï¼Ÿ**
A: ä¸ºäº†ä¸å¤šäººæ¸¸æˆæœåŠ¡å™¨é¡¹ç›®ä¿æŒå­˜æ¡£åŒæ­¥ï¼Œå®ç°ç»Ÿä¸€ç®¡ç†ã€‚

**Q: å¦‚æœç›®æ ‡è·¯å¾„åˆ›å»ºå¤±è´¥æ€ä¹ˆåŠï¼Ÿ**
A: ç³»ç»Ÿä¼šè‡ªåŠ¨é™çº§åˆ°å¤‡ç”¨è·¯å¾„ï¼Œç¡®ä¿æœåŠ¡æ­£å¸¸å¯åŠ¨ã€‚

**Q: å¯ä»¥æ‰‹åŠ¨æŒ‡å®šè·¯å¾„å—ï¼Ÿ**
A: å¯ä»¥ï¼Œé€šè¿‡ Web ç•Œé¢çš„"è·¯å¾„è®¾ç½®"æˆ–ç›´æ¥è°ƒç”¨ API æ¥å£ã€‚

**Q: è·¯å¾„å˜æ›´ä¼šå½±å“ç°æœ‰æ•°æ®å—ï¼Ÿ**  
A: ä¸ä¼šï¼Œåªæ˜¯åˆ‡æ¢è¯»å–ä½ç½®ï¼ŒåŸæœ‰æ•°æ®ä¿æŒä¸å˜ã€‚